<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 880 880" font-family="Segoe UI, Arial, sans-serif" font-size="13">
  <defs>
    <marker id="a" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#555"/>
    </marker>
    <marker id="ad" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#999"/>
    </marker>
    <marker id="ab" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#1976d2"/>
    </marker>
    <marker id="ag" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#2e7d32"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="880" height="880" rx="12" fill="#fafafa" stroke="#e0e0e0"/>

  <!-- ==================== Telegram User ==================== -->
  <rect x="330" y="16" width="200" height="42" rx="21" fill="#2196f3" stroke="#1976d2"/>
  <text x="430" y="42" text-anchor="middle" fill="#fff" font-weight="600">Telegram User</text>

  <!-- Arrows: User <-> Bot -->
  <line x1="380" y1="58" x2="380" y2="102" stroke="#555" stroke-width="1.5" marker-end="url(#a)"/>
  <text x="372" y="85" text-anchor="end" fill="#888" font-size="9">links / .torrent / commands</text>

  <line x1="480" y1="102" x2="480" y2="58" stroke="#1976d2" stroke-width="1.2" marker-end="url(#ab)"/>
  <text x="488" y="85" fill="#1976d2" font-size="9">notifications</text>

  <!-- ==================== Bot group ==================== -->
  <rect x="100" y="104" width="620" height="110" rx="10" fill="#e3f2fd" stroke="#90caf9"/>
  <text x="430" y="124" text-anchor="middle" font-weight="700" fill="#1565c0" font-size="14">Bot</text>
  <text x="430" y="138" text-anchor="middle" fill="#1976d2" font-size="10" font-style="italic">bot.Service</text>

  <!-- Auth -->
  <rect x="120" y="148" width="120" height="34" rx="6" fill="#fff" stroke="#90caf9"/>
  <text x="180" y="170" text-anchor="middle" fill="#555" font-size="11" font-weight="600">Auth</text>

  <!-- Router -->
  <rect x="260" y="148" width="120" height="34" rx="6" fill="#fff" stroke="#90caf9"/>
  <text x="320" y="170" text-anchor="middle" fill="#555" font-size="11" font-weight="600">Router</text>

  <!-- Handlers -->
  <rect x="400" y="148" width="160" height="34" rx="6" fill="#fff" stroke="#90caf9"/>
  <text x="480" y="170" text-anchor="middle" fill="#555" font-size="11" font-weight="600">Handlers</text>

  <!-- Session -->
  <rect x="580" y="148" width="124" height="34" rx="6" fill="#fff" stroke="#90caf9"/>
  <text x="642" y="170" text-anchor="middle" fill="#555" font-size="11" font-weight="600">Sessions</text>

  <!-- Sub-labels under bot -->
  <text x="142" y="198" fill="#888" font-size="9">login | roles | temp pwd</text>
  <text x="456" y="198" fill="#888" font-size="9">/ls /rm /start /temp | callbacks</text>

  <!-- ==================== App struct ==================== -->
  <rect x="280" y="226" width="300" height="44" rx="8" fill="#e0f7fa" stroke="#4dd0e1" stroke-width="1.5"/>
  <text x="430" y="248" text-anchor="middle" font-weight="700" fill="#00695c" font-size="13">App</text>
  <text x="430" y="262" text-anchor="middle" fill="#00897b" font-size="9">Bot + DB + Config + DownloadManager</text>

  <!-- Arrow: Bot -> App -->
  <line x1="430" y1="214" x2="430" y2="224" stroke="#555" stroke-width="1.5" marker-end="url(#a)"/>

  <!-- ==================== Prowlarr (optional) ==================== -->
  <rect x="710" y="222" width="148" height="50" rx="8" fill="#fff" stroke="#bbb" stroke-dasharray="5,3"/>
  <text x="784" y="240" text-anchor="middle" fill="#aaa" font-size="10">optional</text>
  <text x="784" y="256" text-anchor="middle" fill="#555" font-weight="600">Prowlarr</text>
  <line x1="642" y1="182" x2="724" y2="224" stroke="#999" stroke-width="1.1" stroke-dasharray="5,3" marker-end="url(#ad)"/>
  <text x="700" y="200" fill="#999" font-size="9">search</text>

  <!-- ==================== Database ==================== -->
  <rect x="22" y="300" width="168" height="82" rx="8" fill="#fff3e0" stroke="#ffcc80"/>
  <text x="106" y="322" text-anchor="middle" font-weight="600" fill="#e65100">Database</text>
  <text x="106" y="338" text-anchor="middle" fill="#e65100" font-size="10" font-style="italic">database.Database</text>
  <text x="106" y="354" text-anchor="middle" fill="#999" font-size="10">SQLite</text>
  <text x="106" y="370" text-anchor="middle" fill="#999" font-size="9">MovieReader | MovieWriter | AuthStore</text>

  <!-- Arrow: App -> Database -->
  <line x1="280" y1="258" x2="192" y2="316" stroke="#555" stroke-width="1.5" marker-end="url(#a)"/>

  <!-- ==================== Download Manager ==================== -->
  <rect x="230" y="302" width="400" height="80" rx="10" fill="#e8f5e9" stroke="#a5d6a7"/>
  <text x="430" y="322" text-anchor="middle" font-weight="700" fill="#2e7d32" font-size="14">Download Manager</text>
  <text x="430" y="338" text-anchor="middle" fill="#388e3c" font-size="10" font-style="italic">manager.Service</text>

  <!-- Sub-blocks inside DM -->
  <rect x="250" y="348" width="100" height="26" rx="5" fill="#fff" stroke="#a5d6a7"/>
  <text x="300" y="366" text-anchor="middle" fill="#555" font-size="10">Queue</text>

  <rect x="362" y="348" width="110" height="26" rx="5" fill="#fff" stroke="#a5d6a7"/>
  <text x="417" y="366" text-anchor="middle" fill="#555" font-size="10">Semaphore</text>

  <rect x="484" y="348" width="100" height="26" rx="5" fill="#fff" stroke="#a5d6a7"/>
  <text x="534" y="366" text-anchor="middle" fill="#555" font-size="10">Monitor</text>

  <!-- Arrow: App -> DM -->
  <line x1="430" y1="270" x2="430" y2="300" stroke="#555" stroke-width="1.5" marker-end="url(#a)"/>

  <!-- Arrows: DM -> downloaders -->
  <line x1="320" y1="382" x2="230" y2="440" stroke="#555" stroke-width="1.5" marker-end="url(#a)"/>
  <line x1="530" y1="382" x2="620" y2="440" stroke="#555" stroke-width="1.5" marker-end="url(#a)"/>

  <!-- downloader.Downloader label -->
  <text x="240" y="416" fill="#888" font-size="9" font-style="italic">downloader.Downloader</text>
  <text x="530" y="416" fill="#888" font-size="9" font-style="italic">downloader.Downloader</text>

  <!-- ==================== yt-dlp ==================== -->
  <rect x="100" y="442" width="200" height="64" rx="8" fill="#f3e5f5" stroke="#ce93d8"/>
  <text x="200" y="466" text-anchor="middle" font-weight="600" fill="#7b1fa2">yt-dlp</text>
  <text x="200" y="482" text-anchor="middle" fill="#999" font-size="10">streaming video</text>
  <text x="200" y="496" text-anchor="middle" fill="#999" font-size="9">YouTube | VK | RuTube | ...</text>

  <!-- ==================== aria2 ==================== -->
  <rect x="540" y="442" width="200" height="64" rx="8" fill="#fce4ec" stroke="#ef9a9a"/>
  <text x="640" y="466" text-anchor="middle" font-weight="600" fill="#c62828">aria2</text>
  <text x="640" y="482" text-anchor="middle" fill="#999" font-size="10">torrents</text>
  <text x="640" y="496" text-anchor="middle" fill="#999" font-size="9">single-file | multi-file</text>

  <!-- Arrows: downloaders -> File Storage -->
  <line x1="230" y1="506" x2="340" y2="570" stroke="#555" stroke-width="1.5" marker-end="url(#a)"/>
  <line x1="610" y1="506" x2="500" y2="570" stroke="#555" stroke-width="1.5" marker-end="url(#a)"/>

  <!-- ==================== TV Compat (optional) ==================== -->
  <rect x="700" y="552" width="156" height="58" rx="8" fill="#fff" stroke="#bbb" stroke-dasharray="5,3"/>
  <text x="778" y="570" text-anchor="middle" fill="#aaa" font-size="10">optional</text>
  <text x="778" y="586" text-anchor="middle" fill="#555" font-weight="600">TV Compat</text>
  <text x="778" y="600" text-anchor="middle" fill="#999" font-size="9">ffmpeg | ffprobe | remux</text>
  <line x1="618" y1="582" x2="698" y2="582" stroke="#999" stroke-width="1.1" stroke-dasharray="5,3" marker-end="url(#ad)"/>

  <!-- ==================== File Manager ==================== -->
  <rect x="22" y="566" width="170" height="52" rx="8" fill="#e8eaf6" stroke="#9fa8da"/>
  <text x="107" y="588" text-anchor="middle" font-weight="600" fill="#283593">File Manager</text>
  <text x="107" y="604" text-anchor="middle" fill="#999" font-size="9">disk space | cleanup | temp files</text>
  <line x1="250" y1="590" x2="194" y2="590" stroke="#555" stroke-width="1.1" marker-end="url(#a)"/>

  <!-- ==================== File Storage ==================== -->
  <rect x="252" y="566" width="260" height="52" rx="8" fill="#fffde7" stroke="#fff176"/>
  <text x="382" y="588" text-anchor="middle" font-weight="600" fill="#f57f17">File Storage</text>
  <text x="382" y="604" text-anchor="middle" fill="#999" font-size="11">MOVIE_PATH</text>

  <!-- Arrow: Storage -> DLNA -->
  <line x1="382" y1="618" x2="382" y2="668" stroke="#999" stroke-width="1.2" stroke-dasharray="5,3" marker-end="url(#ad)"/>

  <!-- ==================== DLNA ==================== -->
  <rect x="288" y="670" width="190" height="48" rx="8" fill="#fff" stroke="#bbb" stroke-dasharray="5,3"/>
  <text x="383" y="689" text-anchor="middle" fill="#aaa" font-size="10">optional</text>
  <text x="383" y="705" text-anchor="middle" fill="#555" font-weight="600">DLNA | minidlna</text>

  <!-- Arrow: DLNA -> TV -->
  <line x1="383" y1="718" x2="383" y2="764" stroke="#999" stroke-width="1.2" stroke-dasharray="5,3" marker-end="url(#ad)"/>

  <!-- ==================== TV / Smart TV ==================== -->
  <rect x="310" y="766" width="146" height="40" rx="20" fill="#78909c" stroke="#546e7a"/>
  <text x="383" y="791" text-anchor="middle" fill="#fff" font-weight="600">Smart TV</text>

  <!-- ==================== testutils (dashed) ==================== -->
  <rect x="700" y="380" width="156" height="80" rx="8" fill="#fafafa" stroke="#bbb" stroke-dasharray="5,3"/>
  <text x="778" y="400" text-anchor="middle" fill="#aaa" font-size="10">test infrastructure</text>
  <text x="778" y="418" text-anchor="middle" fill="#555" font-weight="600" font-size="12">testutils</text>
  <text x="778" y="436" text-anchor="middle" fill="#888" font-size="9">MockBot | DatabaseStub</text>
  <text x="778" y="450" text-anchor="middle" fill="#888" font-size="9">TestConfig | TestDatabase</text>

  <!-- ==================== Legend ==================== -->
  <rect x="22" y="802" width="260" height="60" rx="6" fill="none" stroke="#ddd"/>
  <text x="34" y="822" fill="#555" font-size="11" font-weight="600">Legend</text>
  <line x1="34" y1="838" x2="64" y2="838" stroke="#555" stroke-width="1.5"/>
  <text x="70" y="842" fill="#888" font-size="10">required dependency</text>
  <line x1="150" y1="838" x2="180" y2="838" stroke="#999" stroke-width="1.2" stroke-dasharray="5,3"/>
  <text x="186" y="842" fill="#888" font-size="10">optional</text>
  <text x="34" y="856" fill="#00897b" font-size="10" font-style="italic">interface name</text>
  <text x="145" y="856" fill="#888" font-size="10">= testable boundary</text>
</svg>
